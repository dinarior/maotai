library(maotai)
library(maotai)
library(maotai)
library(maotai)
# simple test
p = 100
mydim = 10
A = matrix(rnorm(p^2),nrow=p); A=A%*%t(A)
B = matrix(runif(p^2),nrow=p); B=B%*%t(B)
C = diag(p)
library(geigen)
eigAB = eigen(solve(B,A)) ## geigen(B,A) # we need largest so be careful of the order
mylist = list()
V = eigAB$vectors[,1:mydim]; mylist$V = V
myval = sum(diag(t(V)%*%A%*%V))/sum(diag(t(V)%*%B%*%V)); mylist$tr.val = myval
m12 = trio(A,B,dim=mydim, method="2012Ngo")
m9 = trio(A,B,dim=mydim, method="2009Jia")
m7 = trio(A,B,dim=mydim, method="2007Wang")
m3 = trio(A,B,dim=mydim, method="2003Guo")
# try rstiefel's optimization
library(rstiefel)
F2  = function(V){sum(diag(t(V)%*%B%*%V))/sum(diag(t(V)%*%A%*%V))} # top/bottom switch; can we speed up
dF2 = function(V){
aa = sum(diag(t(V)%*%A%*%V))
bb = sum(diag(t(V)%*%B%*%V))
t1 = 2*aa*(B%*%V) - 2*bb*(A%*%V)
t2 = aa^2
return(t1/t2)
}
st.V2 = optStiefel(F2,dF2, Vinit=rustiefel(p,mydim), method="curvilinear",
searchParams=list(rho1=0.1, rho2=0.9, tau=1),tol=1009*.Machine$double.eps)
st.val2 = sum(diag(t(st.V2)%*%A%*%st.V2))/sum(diag(t(st.V2)%*%B%*%st.V2))
library(maotai)
devtools::document()
library(maotai)
# simple test
p = 100
mydim = 10
A = matrix(rnorm(p^2),nrow=p); A=A%*%t(A)
B = matrix(runif(p^2),nrow=p); B=B%*%t(B)
C = diag(p)
library(geigen)
eigAB = eigen(solve(B,A)) ## geigen(B,A) # we need largest so be careful of the order
mylist = list()
V = eigAB$vectors[,1:mydim]; mylist$V = V
myval = sum(diag(t(V)%*%A%*%V))/sum(diag(t(V)%*%B%*%V)); mylist$tr.val = myval
m12 = trio(A,B,dim=mydim, method="2012Ngo")
m9 = trio(A,B,dim=mydim, method="2009Jia")
m7 = trio(A,B,dim=mydim, method="2007Wang")
m3 = trio(A,B,dim=mydim, method="2003Guo")
# try rstiefel's optimization
library(rstiefel)
F2  = function(V){sum(diag(t(V)%*%B%*%V))/sum(diag(t(V)%*%A%*%V))} # top/bottom switch; can we speed up
dF2 = function(V){
aa = sum(diag(t(V)%*%A%*%V))
bb = sum(diag(t(V)%*%B%*%V))
t1 = 2*aa*(B%*%V) - 2*bb*(A%*%V)
t2 = aa^2
return(t1/t2)
}
st.V2 = optStiefel(F2,dF2, Vinit=rustiefel(p,mydim), method="curvilinear",
searchParams=list(rho1=0.1, rho2=0.9, tau=1),tol=1009*.Machine$double.eps)
st.val2 = sum(diag(t(st.V2)%*%A%*%st.V2))/sum(diag(t(st.V2)%*%B%*%st.V2))
st.val2
m3$tr.val
myval
library(maotai)
