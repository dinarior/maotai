plot(elist[[idk[i]]], add=TRUE, verticals=TRUE, lwd=0.25, do.points=FALSE)
}
plot(epout$centers[[k]], add=TRUE, verticals=TRUE, lwd=2, col="red", do.points=FALSE)
}
}
par(opar)
myk   = 4
epout = epmeans(elist, k=myk)
# visualize
opar = par(mfrow=c(1,myk))
for (k in 1:myk){
idk = which(epout$cluster==k)
for (i in 1:length(idk)){
if (i<2){
pm = paste("class",k," : size=",length(idk),sep="")
plot(elist[[idk[i]]], verticals=TRUE, lwd=0.25, do.points=FALSE, main=pm)
} else {
plot(elist[[idk[i]]], add=TRUE, verticals=TRUE, lwd=0.25, do.points=FALSE)
}
plot(epout$centers[[k]], add=TRUE, verticals=TRUE, lwd=2, col="red", do.points=FALSE)
}
}
par(opar)
myk   = 2
epout = epmeans(elist, k=myk)
# visualize
opar = par(mfrow=c(1,myk))
for (k in 1:myk){
idk = which(epout$cluster==k)
for (i in 1:length(idk)){
if (i<2){
pm = paste("class",k," : size=",length(idk),sep="")
plot(elist[[idk[i]]], verticals=TRUE, lwd=0.25, do.points=FALSE, main=pm)
} else {
plot(elist[[idk[i]]], add=TRUE, verticals=TRUE, lwd=0.25, do.points=FALSE)
}
plot(epout$centers[[k]], add=TRUE, verticals=TRUE, lwd=2, col="red", do.points=FALSE)
}
}
par(opar)
# run EP-means with k clusters
# change the value below to see different settings
myk   = 2
epout = epmeans(elist, k=myk)
# visualize
opar = par(mfrow=c(1,myk))
for (k in 1:myk){
idk = which(epout$cluster==k)
for (i in 1:length(idk)){
if (i<2){
pm = paste("class",k," (size=",length(idk),")",sep="")
plot(elist[[idk[i]]], verticals=TRUE, lwd=0.25, do.points=FALSE, main=pm)
} else {
plot(elist[[idk[i]]], add=TRUE, verticals=TRUE, lwd=0.25, do.points=FALSE)
}
plot(epout$centers[[k]], add=TRUE, verticals=TRUE, lwd=2, col="red", do.points=FALSE)
}
}
par(opar)
# run EP-means with k clusters
# change the value below to see different settings
myk   = 2
epout = epmeans(elist, k=myk)
# visualize
opar = par(mfrow=c(1,myk))
for (k in 1:myk){
idk = which(epout$cluster==k)
for (i in 1:length(idk)){
if (i<2){
pm = paste("class ",k," (size=",length(idk),")",sep="")
plot(elist[[idk[i]]], verticals=TRUE, lwd=0.25, do.points=FALSE, main=pm)
} else {
plot(elist[[idk[i]]], add=TRUE, verticals=TRUE, lwd=0.25, do.points=FALSE)
}
plot(epout$centers[[k]], add=TRUE, verticals=TRUE, lwd=2, col="red", do.points=FALSE)
}
}
par(opar)
library(maotai)
library(maotai)
library(maotai)
iris
iris[1:5,1:4]
data(iris)
idata = as.matrix(iris[,1:4])
## run Bayesian MDS
#  let's run 49 iterations (CRAN) quietly
iris.cmds = cmds(idata, ndim=2)
iris.bmds = bmds(idata, ndim=2, mc.iter=49, par.step=(2.38^2))
library(maotai)
iris.bmds = bmds(idata, ndim=2, mc.iter=49, par.step=(2.38^2))
library(maotai)
iris.bmds = bmds(idata, ndim=2, mc.iter=49, par.step=(2.38^2))
library(maotai)
iris.cmds = cmds(idata, ndim=2)
iris.bmds = bmds(idata, ndim=2, mc.iter=10, par.step=(2.38^2))
## extract coordinates and class information
cx = iris.cmds$embed # embedded coordinates of CMDS
bx = iris.bmds$embed #                         BMDS
icol = iris[,5]      # class information
## visualize
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2),pty="s")
mc = paste0("CMDS with STRESS=",round(iris.cmds$stress,4))
mb = paste0("BMDS with STRESS=",round(iris.bmds$stress,4))
plot(cx, col=icol,pch=19,main=mc)
plot(bx, col=icol,pch=19,main=mb)
par(opar)
iris.bmds
names(iris.bmds)
## use simple example of iris dataset with perturbation
data(iris)
idata = as.matrix(iris[,1:4])
## run Bayesian MDS
#  let's run 10 iterations only.
iris.cmds = cmds(idata, ndim=2)
iris.bmds = bmds(idata, ndim=2, mc.iter=10, par.step=(2.38^2))
## extract coordinates and class information
cx = iris.cmds$embed # embedded coordinates of CMDS
bx = iris.bmds$embed #                         BMDS
icol = iris[,5]      # class information
## visualize
opar <- par(no.readonly=TRUE)
par(mfrow=c(1,2),pty="s")
mc = paste0("CMDS with STRESS=",round(iris.cmds$stress,4))
mb = paste0("BMDS with STRESS=",round(iris.bmds$stress,4))
plot(cx, col=icol,pch=19,main=mc)
plot(bx, col=icol,pch=19,main=mb)
par(opar)
opar <- par(no.readonly=TRUE)
par(mfrow=c(2,1))
mc = paste0("CMDS with STRESS=",round(iris.cmds$stress,4))
mb = paste0("BMDS with STRESS=",round(iris.bmds$stress,4))
plot(cx, col=icol,pch=19,main=mc)
plot(bx, col=icol,pch=19,main=mb)
par(opar)
rm(list=ls())
library(maotai)
data(iris)
idata = as.matrix(iris[,1:4])
icol  = as.factor(iris[,5])   # class information
## run Classical MDS
iris.cmds = cmds(idata, ndim=2)
## visualize
opar <- par(no.readonly=TRUE)
plot(iris.cmds$embed, col=icol)
par(opar)
data(iris)
idata = as.matrix(iris[,1:4])
icol  = as.factor(iris[,5])   # class information
## run Classical MDS
iris.cmds = cmds(idata, ndim=2)
## visualize
opar <- par(no.readonly=TRUE)
plot(iris.cmds$embed, col=icol)
par(opar)
opar <- par(no.readonly=TRUE)
plot(iris.cmds$embed, col=icol,
main=paste0("STRESS=",round(iris.cmds$stress,4)))
par(opar)
help("cmdscale")
plot(my2d, col=k2, main="k=2")
## use simple example of iris dataset
data(iris)
mydata = as.matrix(iris[,1:4])
## find the low-dimensional embedding for visualization
my2d = cmds(mydata, ndim=2)
## apply 'kmeanspp' with different numbers of k's.
k2 = kmeanspp(mydata, k=2)
k3 = kmeanspp(mydata, k=3)
k4 = kmeanspp(mydata, k=4)
k5 = kmeanspp(mydata, k=5)
## visualize
opar <- par(no.readonly=TRUE)
par(mfrow=c(2,2))
plot(my2d, col=k2, main="k=2")
plot(my2d, col=k3, main="k=3")
plot(my2d, col=k4, main="k=4")
plot(my2d, col=k5, main="k=5")
par(opar)
library(maotai)
my2d = cmds(mydata, ndim=2)$embed
## apply 'kmeanspp' with different numbers of k's.
k2 = kmeanspp(mydata, k=2)
k3 = kmeanspp(mydata, k=3)
k4 = kmeanspp(mydata, k=4)
k5 = kmeanspp(mydata, k=5)
## visualize
opar <- par(no.readonly=TRUE)
par(mfrow=c(2,2))
plot(my2d, col=k2, main="k=2")
plot(my2d, col=k3, main="k=3")
plot(my2d, col=k4, main="k=4")
plot(my2d, col=k5, main="k=5")
## visualize
opar <- par(no.readonly=TRUE)
par(mfrow=c(2,2))
plot(my2d, col=k2, main="k=2", pch=19, cex=0.8)
plot(my2d, col=k3, main="k=3", pch=19, cex=0.8)
plot(my2d, col=k4, main="k=4", pch=19, cex=0.8)
plot(my2d, col=k5, main="k=5", pch=19, cex=0.8)
par(opar)
## use simple example of iris dataset
data(iris)
mydata = as.matrix(iris[,1:4])
mycol  = as.factor(iris[,5])
## find the low-dimensional embedding for visualization
my2d = cmds(mydata, ndim=2)$embed
## apply 'kmeanspp' with different numbers of k's.
k2 = kmeanspp(mydata, k=2)
k3 = kmeanspp(mydata, k=3)
k4 = kmeanspp(mydata, k=4)
k5 = kmeanspp(mydata, k=5)
k6 = kmeanspp(mydata, k=6)
## visualize
opar <- par(no.readonly=TRUE)
par(mfrow=c(2,3))
plot(my2d, col=k2, main="k=2", pch=19, cex=0.8)
plot(my2d, col=k3, main="k=3", pch=19, cex=0.8)
plot(my2d, col=k4, main="k=4", pch=19, cex=0.8)
plot(my2d, col=k5, main="k=5", pch=19, cex=0.8)
plot(my2d, col=k6, main="k=6", pch=19, cex=0.8)
plot(my2d, col=mycol, main="true cluster", pch=19, cex=0.8)
par(opar)
## visualize
opar <- par(no.readonly=TRUE)
par(mfrow=c(2,3))
plot(my2d, col=k2, main="k=2", pch=19, cex=0.5)
plot(my2d, col=k3, main="k=3", pch=19, cex=0.5)
plot(my2d, col=k4, main="k=4", pch=19, cex=0.5)
plot(my2d, col=k5, main="k=5", pch=19, cex=0.5)
plot(my2d, col=k6, main="k=6", pch=19, cex=0.5)
plot(my2d, col=mycol, main="true cluster", pch=19, cex=0.5)
par(opar)
library(maotai)
help(Rtsne)
library(maotai)
## use simple example of iris dataset
data(iris)
mydat = as.matrix(iris[,1:4])
mylab = as.factor(iris[,5])
## run t-SNE and MDS for comparison
iris.cmds = cmds(mydat, ndim=2)
iris.tsne = tsne(mymat, ndim=2)
## extract coordinates and class information
cx = iris.cmds$embed # embedded coordinates of CMDS
tx = iris.tsne$embed #                         t-SNE
## visualize
#  main title
mc = paste("CMDS with STRESS=",round(iris.cmds$stress,4),sep="")
mt = paste("tSNE with STRESS=",round(iris.tsne$stress,4),sep="")
#  draw a figure
opar <- par(mfrow=c(1,2), pty="s")
plot(cx, col=mylab, pch=19, main=mc)
plot(tx, col=mylab, pch=19, main=mt)
par(opar)
iris.cmds = cmds(mydat, ndim=2)
iris.tsne = tsne(mydat, ndim=2)
## extract coordinates and class information
cx = iris.cmds$embed # embedded coordinates of CMDS
tx = iris.tsne$embed #                         t-SNE
## visualize
#  main title
mc = paste("CMDS with STRESS=",round(iris.cmds$stress,4),sep="")
mt = paste("tSNE with STRESS=",round(iris.tsne$stress,4),sep="")
#  draw a figure
opar <- par(mfrow=c(1,2), pty="s")
plot(cx, col=mylab, pch=19, main=mc)
plot(tx, col=mylab, pch=19, main=mt)
par(opar)
library(maotai)
mylab = as.factor(iris[,5])
## run t-SNE and MDS for comparison
iris.cmds = cmds(mydat, ndim=2)
iris.tsne = tsne(mydat, ndim=2)
## extract coordinates and class information
cx = iris.cmds$embed # embedded coordinates of CMDS
tx = iris.tsne$embed #                         t-SNE
## visualize
#  main title
mc = paste("CMDS with STRESS=",round(iris.cmds$stress,4),sep="")
mt = paste("tSNE with STRESS=",round(iris.tsne$stress,4),sep="")
#  draw a figure
opar <- par(no.readonly=TRUE)
par(mfrow=c(2,1))
plot(cx, col=mylab, pch=19, main=mc)
plot(tx, col=mylab, pch=19, main=mt)
par(opar)
reduced.regress = glm(Class ~ BNucl + Thick + Chrom, data = wbca)
## use simple example of iris dataset
data(iris)
mydat = as.matrix(iris[,1:4])
mylab = as.factor(iris[,5])
## run t-SNE and MDS for comparison
iris.cmds = cmds(mydat, ndim=2)
iris.tsne = tsne(mydat, ndim=2)
## extract coordinates and class information
cx = iris.cmds$embed # embedded coordinates of CMDS
tx = iris.tsne$embed #                         t-SNE
## visualize
#  main title
mc = paste("CMDS with STRESS=",round(iris.cmds$stress,4),sep="")
mt = paste("tSNE with STRESS=",round(iris.tsne$stress,4),sep="")
#  draw a figure
opar <- par(no.readonly=TRUE)
par(mfrow=c(2,1))
plot(cx, col=mylab, pch=19, main=mc)
plot(tx, col=mylab, pch=19, main=mt)
par(opar)
## use simple example of iris dataset
data(iris)
mydat = as.matrix(iris[,1:4])
mylab = as.factor(iris[,5])
## run t-SNE and MDS for comparison
iris.cmds = cmds(mydat, ndim=2)
iris.tsne = tsne(mydat, ndim=2)
## extract coordinates and class information
cx = iris.cmds$embed # embedded coordinates of CMDS
tx = iris.tsne$embed #                         t-SNE
## visualize
#  main title
mc = paste("CMDS with STRESS=",round(iris.cmds$stress,4),sep="")
mt = paste("tSNE with STRESS=",round(iris.tsne$stress,4),sep="")
#  draw a figure
opar <- par(no.readonly=TRUE)
par(mfrow=c(2,1))
plot(cx, col=mylab, pch=19, main=mc)
plot(tx, col=mylab, pch=19, main=mt)
par(opar)
library(maotai)
help(tsne)
library(maotai)
library(maotai)
library(faraway)
#3
pchisq(32.175,2,lower.tail = FALSE)
#4
data<- c(226,109,110)
props<- c(.635,.193,.172)
marj<- chisq.test(data, p = props)
marj$expected
marj$statistic
marj$p.value
#5
?wbca
benign.regress <- glm(
wbca$Class ~ wbca$BNucl + wbca$Thick + wbca$Chrom + wbca$UShap + wbca$USize,
family = "binomial")
predict.values <- data.frame(cbind(median(wbca$BNucl) , median(wbca$Thick) , median(wbca$Chrom) , median(wbca$UShap) , median(wbca$USize)))
predict.values
summary(predict.values)
predict.glm(benign.regress, type = "response", newdata = predict.values)
predict.values <- data.frame(cbind(median(wbca$BNucl) , median(wbca$Thick) , median(wbca$Chrom) , median(wbca$UShap) , median(wbca$USize)))
predict.values
benign.regress
predict.values <- data.frame(cbind(median(wbca$BNucl) , median(wbca$Thick) , median(wbca$Chrom) , median(wbca$UShap) , median(wbca$USize)))
predict.glm(benign.regress, type = "response", newdata = predict.values)
predict.values
predict.glm(benign.regress, type = "response", newdata = predict.values)
benign.regress <- glm(
Class ~ BNucl + Thick + Chrom + UShap + USize,
family = "binomial", data=wbca)
predict(benign.regress, type="response", newdata = predict.values)
benign.regress <- glm(
Class ~ BNucl + Thick + Chrom + UShap + USize,
family = "binomial", data=wbca)
predict.values = data.frame(BNucl=cbind(median(wbca$BNucl),
Thick=median(wbca$Thick),
Chrom=median(wbca$Chrom),
UShap=median(wbca$UShap),
USize=median(wbca$USize)))
predict(benign.regress, type="response", newdata = predict.values)
help(predict)
help(predict.glm)
benign.regress <- glm(
wbca$Class ~ wbca$BNucl + wbca$Thick + wbca$Chrom + wbca$UShap + wbca$USize,
family = "binomial")
predict.values <- data.frame(cbind(median(wbca$BNucl) , median(wbca$Thick) , median(wbca$Chrom) , median(wbca$UShap) , median(wbca$USize)))
predict.glm(benign.regress, type = "response", newdata = predict.values)
rm(list=ls())
library(faraway)
attach(wbca)
library(faraway)
attach(wbca)
benign.regress <- glm(Class~BNucl+Thick+Chrom+UShap+USize, family="binomial")
predict.values <- data.frame(
BNucl=median(BNucl),
Thick=median(Thick),
Chrom=median(Chrom),
UShap=median(UShap),
USize=median(USize)
)
predict.glm(benign.regress, type="response", newdata=predict.values)
detach(wbca)
rm(list=ls())
library(faraway)
data(wbca)
benign.regress <- glm(Class~BNucl+Thick+Chrom+UShap+USize, family="binomial", data=wbca)
benign.regress <- glm(Class~BNucl+Thick+Chrom+UShap+USize, family="binomial", data=wbca)
predict.values <- data.frame(
BNucl = median(wbca$BNucl),
Thick = median(wbca$Thick),
Chrom = median(wbca$Chrom),
UShap = median(wbca$UShap),
USize = median(wbca$USize))
predict.glm(benign.regress, type="response", newdata=predict.values)
predict.values <- data.frame(cbind(median(wbca$BNucl) , median(wbca$Thick) , median(wbca$Chrom) , median(wbca$UShap) , median(wbca$USize)))
predict.glm(benign.regress, type="response", newdata=predict.values)
library(maotai)
library(maotai)
rm(list=ls())
x = dist(matrix(rnorm(10*2),ncol=2))
x
class(x)
help(eigen)
library(maotai)
nem(mydat)
data(iris)
mydat = as.matrix(iris[,1:4])
## calculate NEM
nem(mydat)
data(iris)
mydat = as.matrix(iris[,1:4])
## calculate NEM
nem(mydat)
data(iris)
mydat = as.matrix(iris[,1:4])
## calculate NEM
nem(mydat)
data(iris)
mydat = as.matrix(iris[,1:4])
## calculate NEM
nem(mydat)
data(iris)
mydat = as.matrix(iris[,1:4])
## calculate NEM
nem(mydat)
library(maotai)
library(maotai)
## use simple example of iris dataset
data(iris)
mydat = as.matrix(iris[,1:4])
## calculate NEF
nef(mydat)
## use simple example of iris dataset
data(iris)
mydat = as.matrix(iris[,1:4])
## calculate NEF
nef(mydat)
library(maotai)
library(maotai)
rm(list=ls())
library(maotai)
rm(list=ls())
library(maotai)
emds = getFromNamespace("hidden_emds","maotai")
# example -----------------------------------------------------------------
library(labdsv)
data(bryceveg) # returns a vegetation data.frame
dis.bc <- as.matrix(dsvdis(bryceveg,'bray/curtis')) # calculate a Bray/Curtis
emds = getFromNamespace("hidden_emds","maotai")
out.cmds <- cmds(dis.bc, ndim=2)$embed
out.emds1 <- emds(dis.bc, ndim=2, method="closure")$embed
out.emds2 <- emds(dis.bc, ndim=2, method="gram")$embed
par(mfrow=c(1,3),pty="s")
plot(out.cmds, main="cmds")
plot(out.emds1, main="emds::closure")
plot(out.emds2, main="emds::gram")
par(mfrow=c(3,1))
plot(out.cmds, main="cmds")
plot(out.emds1, main="emds::closure")
plot(out.emds2, main="emds::gram")
rm(list=ls())
graphics.off()
rm(list=ls())
library(maotai)
library(maotai)
library(Rlinsolve)
install.packages("Rlinsolve")
library(Rlinsolve)
aa = diag(5)
bb = aa%*%1:5
bb
lsolve.gmres(aa,bb)
solve(aa,bb)
lsolve.gmres(aa,bb)
help("lsolve.gmres")
## Overdetermined System
A = matrix(rnorm(10*5),nrow=10)
x = rnorm(5)
b = A%*%x
out1 = lsolve.cg(A,b)
out3_1 = lsolve.gmres(A,b,restart=2)
out3_2 = lsolve.gmres(A,b,restart=3)
out3_3 = lsolve.gmres(A,b,restart=4)
matout = cbind(matrix(x),out1$x, out3_1$x, out3_2$x, out3_3$x);
colnames(matout) = c("true x","CG", "GMRES(2)", "GMRES(3)", "GMRES(4)")
print(matout)
lsolve.gmres(aa,bb)
lsolve.gmres(aa,bb)
lsolve.gmres(aa,bb)
lsolve.gmres(aa,bb)
lsolve.gmres(aa,bb, reltol=1e-10)
lsolve.gmres(aa,bb, reltol=1e-10)
lsolve.gmres(aa,bb, reltol=1e-10)
lsolve.gmres(aa,bb, reltol=1e-10)
lsolve.gmres(aa,bb, reltol=1e-20)
lsolve.gmres(aa,bb, reltol=1e-20)
library(maotai)
library(maotai)
library(InspectChangepoint)
help(inspect)
